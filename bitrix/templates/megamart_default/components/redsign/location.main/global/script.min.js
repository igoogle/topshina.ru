BX.namespace("RS"),window.RSLocation||(window.RSLocation=function(){var t=function(t,n){this.data=t,this.params=n,this.confirmPopup=document.getElementById(n.confirmPopupId),this.confirmPopup&&this.isNeedShowConfirm()&&this.showConfirm()},n=function(t,n){return localStorage.setItem(t,n)};return BX.merge(t.prototype,{getCityId:function(){return this.data.ID},getCityName:function(){return this.data.NAME},isNeedShowConfirm:function(){return t="city_confirmed",!localStorage.getItem(t);var t},showConfirm:function(){this.confirmPopup.style.display="block",setTimeout(function(){var t=$(this.confirmPopup);t.hasClass("anim-start")&&t.removeClass("anim-start")}.bind(this),1e3)},hideConfirm:function(){this.confirmPopup.style.display="none",n("city_confirmed",!0)},change:function(t){var n={action:"change",id:t,siteId:this.params.siteId};return this.request(n).then(BX.proxy(this.changeSuccess,this))},changeSuccess:function(t){return this.data=t,n("city_confirmed",!0),BX.onCustomEvent("rs.location_change",[t]),t},request:function(t){var n=new BX.Promise;return t.sessid=BX.bitrix_sessid(),t.backurl=window.location.href,BX.ajax({url:this.params.ajaxUrl,method:"POST",data:t,dataType:"json",onsuccess:function(t){n.resolve(t)},onfailure:function(t){n.reject(t)}}),n}}),t}());